'use client'

import React, { useState, useRef, useEffect, Suspense } from 'react';
import { useRouter } from 'next/navigation'
import { BlogPost } from '@/app/constants';

const BlogPage: React.FC = () => {
  const router = useRouter()
  const [selectedYear, setSelectedYear] = useState<number>(1936);
  const [blogContent, setBlogContent] = useState<string>('');
  const [loading, setLoading] = useState<boolean>(false);
  const contentRef = useRef<HTMLDivElement>(null)

  // Auto-scroll to content on mobile when year changes
  useEffect(() => {
    if (contentRef.current && window.innerWidth < 1024) {
      contentRef.current.scrollIntoView({ behavior: 'smooth', block: 'start' })
    }
  }, [selectedYear])

  // Load content dynamically when year changes
  useEffect(() => {
    const loadContent = async () => {
      setLoading(true);
      try {
        const contentModule = await import(`./content/${selectedYear}.ts`);
        setBlogContent(contentModule.default);
      } catch (error) {
        console.error(`Failed to load content for year ${selectedYear}:`, error);
        setBlogContent('<div class="text-center text-gray-500">Content not available for this year.</div>');
      } finally {
        setLoading(false);
      }
    };

    loadContent();
  }, [selectedYear]);

  // Function to determine the era based on year
  const getEra = (year: number | string | undefined) => {
    if (!year) return { name: 'Modern', color: 'bg-teal-500', icon: 'ðŸ¤–' };
    
    // Convert string years to number if needed (take the first year if range)
    const yearNum = typeof year === 'string' ? parseInt(year.split('-')[0]) : year;
    
    if (yearNum >= 1936 && yearNum <= 1955) return { name: 'Foundations', color: 'bg-purple-500', icon: 'ðŸ§®' };
    if (yearNum >= 1956 && yearNum <= 1969) return { name: 'Birth of AI', color: 'bg-blue-500', icon: 'ðŸ§ ' };
    if (yearNum >= 1970 && yearNum <= 1979) return { name: 'Expert Systems', color: 'bg-green-500', icon: 'ðŸ’¡' };
    if (yearNum >= 1980 && yearNum <= 1989) return { name: 'AI Winter', color: 'bg-gray-500', icon: 'â„ï¸' };
    if (yearNum >= 1990 && yearNum <= 1999) return { name: 'Revival', color: 'bg-orange-500', icon: 'ðŸ”¥' };
    if (yearNum >= 2000 && yearNum <= 2009) return { name: 'Data Era', color: 'bg-cyan-500', icon: 'ðŸ“Š' };
    if (yearNum >= 2010 && yearNum <= 2019) return { name: 'Deep Learning', color: 'bg-indigo-500', icon: 'ðŸš€' };
    if (yearNum >= 2020 && yearNum <= 2025) return { name: 'Transformers', color: 'bg-pink-500', icon: 'âœ¨' };
    return { name: 'Modern', color: 'bg-teal-500', icon: 'ðŸ¤–' };
  };

  // Sample blog posts metadata - content loaded dynamically
