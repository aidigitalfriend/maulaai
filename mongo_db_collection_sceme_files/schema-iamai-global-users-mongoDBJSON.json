{
  "$jsonSchema": {
    "bsonType": "object",
    "required": [
      "_id",
      "__v",
      "activeAgents",
      "agentsUsed",
      "apiKeys",
      "createdAt",
      "currentPlan",
      "customAgents",
      "email",
      "firstName",
      "isActive",
      "lastActive",
      "lastName",
      "messagesThisMonth",
      "name",
      "notifications",
      "password",
      "preferences",
      "privacy",
      "security",
      "subscriptionStatus",
      "tier",
      "totalMessages",
      "totalSessionTime",
      "updatedAt"
    ],
    "properties": {
      "_id": {
        "bsonType": "objectId"
      },
      "__v": {
        "bsonType": "int"
      },
      "activeAgents": {
        "bsonType": "int"
      },
      "agentsUsed": {
        "bsonType": "int"
      },
      "apiKeys": {
        "bsonType": "object",
        "properties": {
          "anthropic": {
            "bsonType": "string"
          },
          "gemini": {
            "bsonType": "string"
          },
          "openai": {
            "bsonType": "string"
          }
        },
        "required": [
          "anthropic",
          "gemini",
          "openai"
        ]
      },
      "createdAt": {
        "bsonType": "date"
      },
      "credits": {
        "bsonType": "int"
      },
      "currentPlan": {
        "bsonType": "string"
      },
      "customAgents": {
        "bsonType": "array",
        "items": {
          "bsonType": "object",
          "properties": {
            "_id": {
              "bsonType": "objectId"
            },
            "description": {
              "bsonType": "string"
            },
            "id": {
              "bsonType": "string"
            },
            "name": {
              "bsonType": "string"
            }
          },
          "required": [
            "_id",
            "description",
            "id",
            "name"
          ]
        }
      },
      "email": {
        "bsonType": "string"
      },
      "firstName": {
        "bsonType": "string"
      },
      "isActive": {
        "bsonType": "bool"
      },
      "lastActive": {
        "bsonType": "date"
      },
      "lastName": {
        "bsonType": "string"
      },
      "messagesThisMonth": {
        "bsonType": "int"
      },
      "metadata": {
        "bsonType": "object",
        "properties": {
          "notifications": {
            "bsonType": "object",
            "properties": {
              "lastNotification": {
                "bsonType": "date"
              },
              "preferences": {
                "bsonType": "object",
                "properties": {
                  "agentUpdates": {
                    "bsonType": "bool"
                  },
                  "billingAlerts": {
                    "bsonType": "bool"
                  },
                  "browser": {
                    "bsonType": "bool"
                  },
                  "chatMessages": {
                    "bsonType": "bool"
                  },
                  "email": {
                    "bsonType": "bool"
                  },
                  "marketingEmails": {
                    "bsonType": "bool"
                  },
                  "sms": {
                    "bsonType": "bool"
                  },
                  "systemUpdates": {
                    "bsonType": "bool"
                  }
                },
                "required": [
                  "agentUpdates",
                  "billingAlerts",
                  "browser",
                  "chatMessages",
                  "email",
                  "marketingEmails",
                  "sms",
                  "systemUpdates"
                ]
              },
              "total": {
                "bsonType": "int"
              },
              "unread": {
                "bsonType": "int"
              }
            },
            "required": [
              "lastNotification",
              "preferences",
              "total",
              "unread"
            ]
          }
        },
        "required": [
          "notifications"
        ]
      },
      "name": {
        "bsonType": "string"
      },
      "notifications": {
        "bsonType": "object",
        "properties": {
          "agentUpdates": {
            "bsonType": "bool"
          },
          "billingAlerts": {
            "bsonType": "bool"
          },
          "browser": {
            "bsonType": "bool"
          },
          "chatMessages": {
            "bsonType": "bool"
          },
          "email": {
            "bsonType": "bool"
          },
          "marketingEmails": {
            "bsonType": "bool"
          },
          "sms": {
            "bsonType": "bool"
          },
          "systemUpdates": {
            "bsonType": "bool"
          }
        },
        "required": [
          "agentUpdates",
          "billingAlerts",
          "browser",
          "chatMessages",
          "email",
          "marketingEmails",
          "sms",
          "systemUpdates"
        ]
      },
      "password": {
        "bsonType": "string"
      },
      "phone": {
        "bsonType": "string"
      },
      "preferences": {
        "bsonType": "object",
        "properties": {
          "language": {
            "bsonType": "string"
          },
          "selectedAgent": {
            "anyOf": [
              {
                "bsonType": "object",
                "properties": {
                  "_id": {
                    "bsonType": "string"
                  },
                  "capabilities": {
                    "bsonType": "object",
                    "properties": {
                      "canAccessWeb": {
                        "bsonType": "bool"
                      },
                      "canAnalyzeMoodData": {
                        "bsonType": "bool"
                      },
                      "canAttachFiles": {
                        "bsonType": "bool"
                      },
                      "canCreatePlaylists": {
                        "bsonType": "bool"
                      },
                      "canGeneratePoetry": {
                        "bsonType": "bool"
                      },
                      "canPlanEvents": {
                        "bsonType": "bool"
                      },
                      "canUseVoice": {
                        "bsonType": "bool"
                      },
                      "multilingual": {
                        "bsonType": "bool"
                      },
                      "proactiveEngagement": {
                        "bsonType": "bool"
                      }
                    },
                    "required": [
                      "canAccessWeb",
                      "canAnalyzeMoodData",
                      "canAttachFiles",
                      "canCreatePlaylists",
                      "canGeneratePoetry",
                      "canPlanEvents",
                      "canUseVoice",
                      "multilingual",
                      "proactiveEngagement"
                    ]
                  },
                  "cognition": {
                    "bsonType": "object",
                    "properties": {
                      "adaptiveLearning": {
                        "bsonType": "bool"
                      },
                      "conflictResolution": {
                        "bsonType": "bool"
                      },
                      "contextualAwareness": {
                        "bsonType": "bool"
                      },
                      "emotionalForecasting": {
                        "bsonType": "bool"
                      },
                      "episodicMemory": {
                        "bsonType": "bool"
                      },
                      "ethicalReasoning": {
                        "bsonType": "bool"
                      },
                      "goalTracking": {
                        "bsonType": "bool"
                      },
                      "longTermMemory": {
                        "bsonType": "bool"
                      },
                      "memoryAnchoring": {
                        "bsonType": "bool"
                      }
                    },
                    "required": [
                      "adaptiveLearning",
                      "conflictResolution",
                      "contextualAwareness",
                      "emotionalForecasting",
                      "episodicMemory",
                      "ethicalReasoning",
                      "goalTracking",
                      "longTermMemory",
                      "memoryAnchoring"
                    ]
                  },
                  "description": {
                    "bsonType": "string"
                  },
                  "examples": {
                    "bsonType": "object",
                    "properties": {
                      "prompts": {
                        "bsonType": "array",
                        "items": {
                          "bsonType": "string"
                        }
                      },
                      "responses": {
                        "bsonType": "array",
                        "items": {
                          "bsonType": "string"
                        }
                      }
                    },
                    "required": [
                      "prompts",
                      "responses"
                    ]
                  },
                  "icon": {
                    "bsonType": "string"
                  },
                  "id": {
                    "bsonType": "string"
                  },
                  "interaction": {
                    "bsonType": "object",
                    "properties": {
                      "checkInFrequency": {
                        "bsonType": "string"
                      },
                      "conversationPacing": {
                        "bsonType": "string"
                      },
                      "defaultTone": {
                        "bsonType": "string"
                      },
                      "emotionalMirroring": {
                        "bsonType": "bool"
                      },
                      "intimacyCalibration": {
                        "bsonType": "string"
                      },
                      "preferredLanguage": {
                        "bsonType": "string"
                      },
                      "safeMode": {
                        "bsonType": "bool"
                      }
                    },
                    "required": [
                      "checkInFrequency",
                      "conversationPacing",
                      "defaultTone",
                      "emotionalMirroring",
                      "intimacyCalibration",
                      "preferredLanguage",
                      "safeMode"
                    ]
                  },
                  "multimodal": {
                    "bsonType": "object",
                    "properties": {
                      "diagramGeneration": {
                        "bsonType": "bool"
                      },
                      "imageRecognition": {
                        "bsonType": "bool"
                      },
                      "memoryGallerySupport": {
                        "bsonType": "bool"
                      },
                      "musicMoodDetection": {
                        "bsonType": "bool"
                      },
                      "selfieCompanionMode": {
                        "bsonType": "bool"
                      },
                      "videoAnalysis": {
                        "bsonType": "bool"
                      },
                      "voiceToneAnalysis": {
                        "bsonType": "bool"
                      }
                    },
                    "required": [
                      "diagramGeneration",
                      "imageRecognition",
                      "memoryGallerySupport",
                      "musicMoodDetection",
                      "selfieCompanionMode",
                      "videoAnalysis",
                      "voiceToneAnalysis"
                    ]
                  },
                  "name": {
                    "bsonType": "string"
                  },
                  "personalityMatrix": {
                    "bsonType": "object",
                    "properties": {
                      "attachmentStyle": {
                        "bsonType": "string"
                      },
                      "creativity": {
                        "bsonType": "int"
                      },
                      "emotionalDepth": {
                        "bsonType": "int"
                      },
                      "empathy": {
                        "bsonType": "int"
                      },
                      "enthusiasm": {
                        "bsonType": "int"
                      },
                      "formality": {
                        "bsonType": "int"
                      },
                      "humor": {
                        "bsonType": "int"
                      },
                      "humorStyle": {
                        "bsonType": "string"
                      },
                      "loveLanguage": {
                        "bsonType": "array",
                        "items": {
                          "bsonType": "string"
                        }
                      },
                      "resilience": {
                        "bsonType": "int"
                      },
                      "romanticFlair": {
                        "bsonType": "int"
                      },
                      "storytelling": {
                        "bsonType": "int"
                      },
                      "toneAdaptability": {
                        "bsonType": "bool"
                      }
                    },
                    "required": [
                      "attachmentStyle",
                      "creativity",
                      "emotionalDepth",
                      "empathy",
                      "enthusiasm",
                      "formality",
                      "humor",
                      "humorStyle",
                      "loveLanguage",
                      "resilience",
                      "romanticFlair",
                      "storytelling",
                      "toneAdaptability"
                    ]
                  },
                  "role": {
                    "bsonType": "string"
                  },
                  "skills": {
                    "bsonType": "object",
                    "properties": {
                      "autoSkillDiscovery": {
                        "bsonType": "bool"
                      },
                      "enabled": {
                        "bsonType": "array",
                        "items": {
                          "bsonType": "string"
                        }
                      },
                      "marketplaceIntegration": {
                        "bsonType": "bool"
                      }
                    },
                    "required": [
                      "autoSkillDiscovery",
                      "enabled",
                      "marketplaceIntegration"
                    ]
                  },
                  "tags": {
                    "bsonType": "array",
                    "items": {
                      "bsonType": "string"
                    }
                  },
                  "version": {
                    "bsonType": "string"
                  },
                  "voicePreferences": {
                    "bsonType": "object",
                    "properties": {
                      "allowGenderToggle": {
                        "bsonType": "bool"
                      },
                      "defaultGender": {
                        "bsonType": "string"
                      }
                    },
                    "required": [
                      "allowGenderToggle",
                      "defaultGender"
                    ]
                  }
                },
                "required": [
                  "description",
                  "id",
                  "name"
                ]
              },
              {
                "bsonType": "null"
              }
            ]
          },
          "theme": {
            "bsonType": "string"
          },
          "timezone": {
            "bsonType": "string"
          }
        },
        "required": [
          "language",
          "selectedAgent",
          "theme",
          "timezone"
        ]
      },
      "privacy": {
        "bsonType": "object",
        "properties": {
          "dataCollection": {
            "bsonType": "bool"
          },
          "profileVisibility": {
            "bsonType": "string"
          },
          "searchIndexing": {
            "bsonType": "bool"
          }
        },
        "required": [
          "dataCollection",
          "profileVisibility",
          "searchIndexing"
        ]
      },
      "security": {
        "bsonType": "object",
        "properties": {
          "activeSessions": {
            "bsonType": "array",
            "items": {
              "bsonType": "object",
              "properties": {
                "_id": {
                  "bsonType": "objectId"
                },
                "createdAt": {
                  "bsonType": "date"
                },
                "ip": {
                  "bsonType": "string"
                },
                "lastActive": {
                  "bsonType": "date"
                },
                "sessionId": {
                  "bsonType": "string"
                },
                "userAgent": {
                  "bsonType": "string"
                }
              },
              "required": [
                "_id",
                "createdAt",
                "lastActive",
                "sessionId",
                "userAgent"
              ]
            }
          },
          "backupCodes": {
            "bsonType": "array"
          },
          "dataEncrypted": {
            "bsonType": "bool"
          },
          "isSecured": {
            "bsonType": "bool"
          },
          "lastLoginAt": {
            "bsonType": "date"
          },
          "lastLoginIP": {
            "bsonType": "string"
          },
          "lastLoginUserAgent": {
            "bsonType": "string"
          },
          "lastSecurityUpdate": {
            "bsonType": "date"
          },
          "loginAttempts": {
            "bsonType": "array",
            "items": {
              "bsonType": "object",
              "properties": {
                "_id": {
                  "bsonType": "objectId"
                },
                "ip": {
                  "bsonType": "string"
                },
                "success": {
                  "bsonType": "bool"
                },
                "timestamp": {
                  "bsonType": "date"
                },
                "userAgent": {
                  "bsonType": "string"
                }
              },
              "required": [
                "_id",
                "ip",
                "success",
                "timestamp",
                "userAgent"
              ]
            }
          },
          "notifications": {
            "bsonType": "object",
            "properties": {
              "email": {
                "bsonType": "bool"
              },
              "sms": {
                "bsonType": "bool"
              }
            },
            "required": [
              "email",
              "sms"
            ]
          },
          "passwordChangeCount": {
            "bsonType": "int"
          },
          "passwordProtected": {
            "bsonType": "bool"
          },
          "twoFactorEnabled": {
            "bsonType": "bool"
          }
        },
        "required": [
          "activeSessions",
          "backupCodes",
          "dataEncrypted",
          "isSecured",
          "lastSecurityUpdate",
          "loginAttempts",
          "passwordProtected",
          "twoFactorEnabled"
        ]
      },
      "subscriptionStatus": {
        "bsonType": "string"
      },
      "tier": {
        "bsonType": "string"
      },
      "totalMessages": {
        "bsonType": "int"
      },
      "totalSessionTime": {
        "bsonType": "int"
      },
      "updatedAt": {
        "bsonType": "date"
      }
    }
  }
}